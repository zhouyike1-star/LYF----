# 山东非遗可视化演示系统 - 沉浸式演示模块说明书

**模块负责人:** 23110908050 杨立栋 (组员 E)

---

## 一、 模块概述

本模块旨在提升系统的**可视化表现力**和**交互体验**。区别于传统的静态地图展示，“沉浸式演示”模块引入了动态热力渲染、自动化漫游飞越以及智能感知导览 (Smart HUD) 技术，为用户提供“上帝视角”般的非遗文化巡览体验。

## 二、 核心功能

### 1. 空间统计热力图 (Spatial Statistic Heatmap)
系统摒弃了传统的简单点密度渲染，采用了更具分析价值的**空间统计分析**技术。
*   **算法逻辑**: 采用 "Point-in-Polygon" (点在面内) 算法，实时统计每个行政区划内的非遗点位数量。
*   **视觉表达**: 使用分级设色 (Choropleth)，从浅黄到深红 (Yellow-to-Red) 直观展示非遗分布密度。红色越深，代表该区域非遗文化越丰富。
*   **技术亮点**: 自动处理坐标系投影 (Projection)，确保不同来源的 SHP 数据能精确匹配。

### 2. 自动化漫游飞越 (Automated Fly-over)
一键启动的自动巡航模式，适用于大屏展示或无人值守演示。
*   **平滑运镜**: 基于高频定时器 (High-frequency Timer) 的平滑插值算法，实现地图视角的流畅平移，杜绝画面卡顿和跳跃。
*   **多速模式**: 提供“正常巡览 (30s)”和“快速概览 (10s)”两种速度模式，满足不同场景需求。

### 3. [创新] 智能感知导览 (Smart HUD)
这是本模块的创新亮点。在漫游过程中，系统不再是“盲飞”，而是具备了环境感知能力。
*   **抬头显示 (HUD)**: 借鉴战斗机 HUD 概念，在屏幕下方悬浮显示动态数据面板。
*   **实时感知**: 系统实时计算屏幕中心点坐标，检索当前飞越的行政区划名称及非遗统计数据。
*   **动态交互**: 数据随镜头移动实时更新，例如：“智能导览: 当前正在飞越 [济南市] | 该区域非遗数量: 25 项”。

### 4. [美化] 多媒体详情卡片 (Enhanced Info Card)
为了提供更好的交互体验，我们对原有的属性弹窗进行了深度美化和功能扩展。
*   **分屏布局**: 采用 `SplitContainer` 上下分屏设计。上半部分大屏展示非遗影像，下半部分清晰列出属性数据。
*   **多媒体支持**: 不仅支持 **图片 (Image)**，还增加了对 **视频 (Video)** 字段的识别。
*   **交互增强**:
    *   **双击查看原图**: 支持双击图片调用系统默认查看器打开高清原图。
    *   **视频关联播放**: 检测到视频路径时，显示播放引导按钮，一键调起播放器。
*   **自动适配**: 窗体尺寸会根据内容自动调整优化 (600x700)，黑色背景衬托影像质感。

---

## 三、 技术架构与优化

*   **代码隔离 (Code Isolation)**: 所有逻辑封装于 `VisualHelper.cs`，通过 `InitVisualModule` 接口与主程序松耦合，完全符合团队协作规范。
*   **性能优化 (Performance)**:
    *   **HUD 复用**: 采用对象池思想复用 `ITextElement`，避免高频绘图导致的内存溢出 (AccessViolationException)。
    *   **坐标缓存**: 预先缓存图层引用和空间参考，减少每一帧的 COM 接口调用开销。
*   **鲁棒性设计 (Robustness)**:
    *   包含完善的异常处理 (Try-Catch) 和资源释放 (ReleaseComObject)，确保在停止漫游或数据异常时系统稳定运行。

## 四、 操作手册

1.  **生成热力图**:
    *   菜单路径: `沉浸式演示(Visual)` -> `生成热力图`
    *   *提示*: 请确保已加载非遗点图层和行政区划(shiqu)图层。

2.  **启动漫游**:
    *   菜单路径: `沉浸式演示(Visual)` -> `开启/停止 漫游`
    *   在弹出的对话框中选择 **是(Yes)** 体验最佳平滑效果。
    *   *观察*: 屏幕下方会自动出现蓝色 HUD 导览条。

3.  **停止漫游**:
    *   漫游会自动在到达地图边缘时停止。
    *   也可随时点击菜单中的 `开启/停止 漫游` -> 选择 `取消` 或 `否` 强制结束。

4.  **点选查询详情**:
    *   若当前处于“漫游手型”或“缩放状态”，请先点击菜单 `切换鼠标为指针 (Pointer)` 或界面上的 **[选择]** 按钮。
    *   使用鼠标左键点击地图上的非遗点，即可弹出增强版多媒体详情卡片。

---

*文档生成日期: 2026-01-06*
