# 实习工作报告：非遗可视化系统 - 数据看板模块

**姓名**：王亮 (23110908016)  
**角色**：开发组员 B (数据看板负责人)  
**日期**：2026-01-06

---

## 一、 工作综述 (Work Summary)

在本次实习项目中，我作为组员 B，主导了“山东省非遗可视化系统”中**数据看板 (Dashboard) 子系统**的深度集成。除了完成基础的图表展示外，我成功攻克了**时空演变分析**中的多项底层技术难题，实现了看板、地图与时间的**三维联动**（数-图-时），将系统从“演示原型”推向了“生产级可用”的高度。

## 二、 核心功能实现 (Key Features)

### 1. 多维统计看板
*   **动态图表**：集成了柱状图、折线图、饼图，支持用户根据分析需求实时切换视图。
*   **精准统计**：实现了 16 地市数据的自动聚合，解决了地市名称模糊匹配（如“济南”与“济南市”）的鲁棒性问题。

### 2. 时空演变分析 (Real-time Spatio-temporal Analysis)
*   **基于真实数据**：完全摒弃了早期的随机模拟算法，直接读取 Shapefile 中的 `公布时间` (Double 型) 字段。
*   **双模查询逻辑**：
    *   **年份模式**：支持按具体年份（如 2006, 2011）进行精确的时序筛选。
    *   **批次模式**：智能识别“批次”型数据（1-5 批），并建立“滑块年份 -> 国家级批次”的映射矩阵，实现了历史数据的平滑“回溯”。

### 3. 图表-地图双向联动 (Interactive Linkage)
*   **空间定位反查**：点击图表柱体自动触发地图缩放（Zoom To City）。
*   **智能图层路由**：开发了智能图层匹配算法，优先定位行政区划面图层，无面层时自动切换至点图层并优化视野，解决了 GIS 多图层混杂模式下的定位偏差问题。
*   **地图时空同步**：拖动滑块时，地图要素通过 `DefinitionExpression` 进行实时 SQL 过滤，实现了非遗项目随时间流逝而动态“生长”的视觉效果。

### 4. 数据中台深度集成 (Data Fusion)
*   **API 链路打通**：通过 `Form1.GetCountByCity` 接口，将前端看板与组员 D 开发的 `DataHelper` 统计引擎无缝链接。
*   **可视化反馈**：增加了“诊断级/交互级”图表标题，实时显示当前年份下的数据总量及查询状态，提升了用户体验。

## 三、 问题解决 (Troubleshooting & Debugging)

在集成阶段，我独立排查并解决了以下关键技术“坑点”：

1.  **项目编译失效 (CSPROJ 修复)**：
    *   *现象*：代码明明存在但系统提示找不到定义。
    *   *解决*：发现 `.csproj` 文件未记录数据接口类，通过手动修复项目配置，成功恢复了编译链路。
2.  **“拖动无变化 (始终 185)”逻辑 Bug**：
    *   *病因*：原始字段存的是“批次 (1, 2, 3...)”，滑块给的是“年份 (2000+)”。由于 5 < 2000 永远成立，导致过滤失效。
    *   *药方*：引入“年份-批次对照映射”逻辑，将 2006 年后的数据映射到第 1 批，2021 年之后映射到第 5 批。
3.  **SQL 语法兼容性 (Double vs String)**：
    *   *挑战*：`公布时间` 字段在 GIS 中是数字型，而 SQL 习惯性加了单引号 `'2005'`，导致部分图层查询返回 0。
    *   *解决*：动态检测字段类型，实现了“去引号”的纯数值 SQL 原子查询。

## 四、 实习心得 (Conclusion)

通过本次开发，我深刻体会到：**数据可视化绝不仅仅是画图，其核心难点在于底层数据的逻辑清洗与场景适配。** 尤其是在处理 GIS 空间数据时，字段格式的多样性（数字、文本、批次）对算法的普适性提出了极高要求。

在团队中，我不仅提升了 ArcObjects API 的工程实践能力，更学会了如何在发现数据异常时，通过技术手段（如双模查询或智能映射）来弥补数据规范的不一致性，这对我未来的架构设计思维大有裨益。

---
*(报告已归档至项目交付目录：交付报告/实习工作报告_MemberB.md)*
